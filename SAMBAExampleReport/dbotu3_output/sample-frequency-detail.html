<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>q2_feature_table : summarize</title>
    <link rel="stylesheet" href="./q2templateassets/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="./q2templateassets/css/normalize.css"/>
    <link rel="stylesheet" href="./q2templateassets/css/base-template.css"/>
    <script src="./q2templateassets/js/jquery-3.2.0.min.js" charset="utf-8"></script>
    <script src="./q2templateassets/js/bootstrap.min.js" charset="utf-8"></script>
    
<script src="js/vega.min.js"></script>
<script src="js/vega-embed.min.js"></script>
<link rel="stylesheet" type="text/css" href="css/spinkit.css" /> 
  </head>
  <body>
    <div class="container-fluid">
      <div id="q2templatesheader" class="row">
        <div class="col-lg-12">
          <a href="http://qiime2.org/">
            <img src="./q2templateassets/img/qiime2-rect-200.png"
            alt="QIIME 2">
          </a>
        </div>
      </div>
        

  <div class="row">
    <div class="col-lg-12">
      <ul class="nav nav-tabs">
        
          <li class="">
            <a href="index.html">
              Overview
            </a>
          </li>
        
          <li class="active">
            <a href="sample-frequency-detail.html">
              Interactive Sample Detail
            </a>
          </li>
        
          <li class="">
            <a href="feature-frequency-detail.html">
              Feature Detail
            </a>
          </li>
        
      </ul>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-12">
      


<div class="row">

  <div class="col-lg-8">
    <div id="plot">
      <div id="loading" class="spinner">
        <div class="rect1"></div>
        <div class="rect2"></div>
        <div class="rect3"></div>
        <div class="rect4"></div>
        <div class="rect5"></div>
      </div>
    </div>
  </div>

  <div class="col-lg-4">
    <div class="row">
      <div class="col-lg-12">
        <h3>Plot Controls</h3>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-12" id="toolbar"></div>
    </div>

    <div class="row">
      <div class="col-lg-12" id="metadata-category"></div>
    </div>

    <div class="row">
      <div class="col-lg-12" id="sampling-depth-slider"></div>
    </div>

    <div class="row">
      <div class="col-lg-12" id="text-field"></div>
    </div>
  </div>

</div>






<script type="text/javascript">
  function handleErrors(errors, element, msg) {
    console.error(errors);
    msg = msg === undefined ? '' : msg + '<br><br>';
    var helpMsg = '<p class="alert alert-danger"> \
                   There was an error loading and rendering the \
                   visualization.<br><br>' + msg + 'Please \
                   copy-and-paste the following error messages when \
                   reporting this error (please be aware that the content \
                   of your analysis data and/or metadata is included in \
                   these messages):</p>';
    var helpMsgDiv = $('<div></div>');
    helpMsgDiv.append(helpMsg);
    helpMsgDiv.append('<pre><code>' + errors.join('\n\n') + '</code></pre>');
    element.replaceWith(helpMsgDiv);
  }
  window.onerror = function(error) {
    handleErrors([error], $('#loading'));
  };
</script>
<script id="spec" type="application/json">
{"$schema": "https://vega.github.io/schema/vega/v5.json", "autosize": {"contains": "content", "type": "fit-x", "resize": true}, "width": 800, "data": [{"transform": [{"as": "selectedCategory", "expr": "datum.metadata[category]", "type": "formula"}], "name": "table", "values": [{"id": "Cpa0h1", "metadata": {"barcode": "TTACTC", "material": "PA6", "time": "0d", "replicat": 1.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 65077.0}, {"id": "Cpa0h2", "metadata": {"barcode": "ATTAGG", "material": "PA6", "time": "0d", "replicat": 2.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 40479.0}, {"id": "Cpa15j1", "metadata": {"barcode": "CGGAAC", "material": "PA6", "time": "15d", "replicat": 1.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 18890.0}, {"id": "Cpa15j2", "metadata": {"barcode": "ATTTGT", "material": "PA6", "time": "15d", "replicat": 2.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 21089.0}, {"id": "Cpa15j3", "metadata": {"barcode": "GCCCAC", "material": "PA6", "time": "15d", "replicat": 3.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 15879.0}, {"id": "Cpa18h1", "metadata": {"barcode": "CCAAGC", "material": "PA6", "time": "01d", "replicat": 1.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 52281.0}, {"id": "Cpa18h2", "metadata": {"barcode": "GCACTG", "material": "PA6", "time": "01d", "replicat": 2.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 42027.0}, {"id": "Cpa18h3", "metadata": {"barcode": "CGTTAA", "material": "PA6", "time": "01d", "replicat": 3.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 40354.0}, {"id": "Cpa21j1", "metadata": {"barcode": "AACCAT", "material": "PA6", "time": "21d", "replicat": 1.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 46970.0}, {"id": "Cpa21j2", "metadata": {"barcode": "GGGGGA", "material": "PA6", "time": "21d", "replicat": 2.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 40930.0}, {"id": "Cpa21j3", "metadata": {"barcode": "TAGTAC", "material": "PA6", "time": "21d", "replicat": 3.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 39262.0}, {"id": "Cpa24h1", "metadata": {"barcode": "GTGTAG", "material": "PA6", "time": "02d", "replicat": 1.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 25647.0}, {"id": "Cpa24h2", "metadata": {"barcode": "CACCTC", "material": "PA6", "time": "02d", "replicat": 2.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 42824.0}, {"id": "Cpa24h3", "metadata": {"barcode": "TAAATG", "material": "PA6", "time": "02d", "replicat": 3.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 35865.0}, {"id": "Cpa5j1", "metadata": {"barcode": "CTTGAC", "material": "PA6", "time": "05d", "replicat": 1.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 37588.0}, {"id": "Cpa5j2", "metadata": {"barcode": "TTAAGG", "material": "PA6", "time": "05d", "replicat": 2.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 34470.0}, {"id": "Cpa5j3", "metadata": {"barcode": "AAGTAA", "material": "PA6", "time": "05d", "replicat": 3.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 35638.0}, {"id": "Cpa8j1", "metadata": {"barcode": "GCTTCG", "material": "PA6", "time": "08d", "replicat": 1.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 35356.0}, {"id": "Cpa8j2", "metadata": {"barcode": "AGAATC", "material": "PA6", "time": "08d", "replicat": 2.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 44787.0}, {"id": "Cpa8j3", "metadata": {"barcode": "GACTTT", "material": "PA6", "time": "08d", "replicat": 3.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 49522.0}, {"id": "Cpet0h1", "metadata": {"barcode": "GCCTAA", "material": "PET", "time": "0d", "replicat": 1.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 66305.0}, {"id": "Cpet0h2", "metadata": {"barcode": "AAAGCG", "material": "PET", "time": "0d", "replicat": 2.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 59018.0}, {"id": "Cpet15j1", "metadata": {"barcode": "AACGTC", "material": "PET", "time": "15d", "replicat": 1.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 18551.0}, {"id": "Cpet15j2", "metadata": {"barcode": "TGTCGT", "material": "PET", "time": "15d", "replicat": 2.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 18909.0}, {"id": "Cpet15j3", "metadata": {"barcode": "CACTAA", "material": "PET", "time": "15d", "replicat": 3.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 17485.0}, {"id": "Cpet18h1", "metadata": {"barcode": "GACGAT", "material": "PET", "time": "01d", "replicat": 1.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 27336.0}, {"id": "Cpet18h2", "metadata": {"barcode": "ATTCTC", "material": "PET", "time": "01d", "replicat": 2.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 38005.0}, {"id": "Cpet18h3", "metadata": {"barcode": "CGAAGG", "material": "PET", "time": "01d", "replicat": 3.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 24351.0}, {"id": "Cpet21j1", "metadata": {"barcode": "TTGACT", "material": "PET", "time": "21d", "replicat": 1.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 42413.0}, {"id": "Cpet21j2", "metadata": {"barcode": "ACATTA", "material": "PET", "time": "21d", "replicat": 2.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 40278.0}, {"id": "Cpet21j3", "metadata": {"barcode": "GGGTCT", "material": "PET", "time": "21d", "replicat": 3.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 36480.0}, {"id": "Cpet24h1", "metadata": {"barcode": "TTGAAG", "material": "PET", "time": "02d", "replicat": 1.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 22113.0}, {"id": "Cpet24h2", "metadata": {"barcode": "AAAGTA", "material": "PET", "time": "02d", "replicat": 2.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 29362.0}, {"id": "Cpet24h3", "metadata": {"barcode": "TCAGCG", "material": "PET", "time": "02d", "replicat": 3.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 23578.0}, {"id": "Cpet5j1", "metadata": {"barcode": "AGGCGC", "material": "PET", "time": "05d", "replicat": 1.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 26254.0}, {"id": "Cpet5j2", "metadata": {"barcode": "AATCCG", "material": "PET", "time": "05d", "replicat": 2.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 28662.0}, {"id": "Cpet5j3", "metadata": {"barcode": "TGATGC", "material": "PET", "time": "05d", "replicat": 3.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 41489.0}, {"id": "Cpet8j1", "metadata": {"barcode": "ATCTAT", "material": "PET", "time": "08d", "replicat": 1.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 36578.0}, {"id": "Cpet8j2", "metadata": {"barcode": "TAGATC", "material": "PET", "time": "08d", "replicat": 2.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 38671.0}, {"id": "Cpet8j3", "metadata": {"barcode": "GTGAAT", "material": "PET", "time": "08d", "replicat": 3.0, "extraction_method": "CTAB", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 37558.0}, {"id": "Ppa0h1", "metadata": {"barcode": "TTGCTA", "material": "PA6", "time": "0d", "replicat": 1.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 26.0}, {"id": "Ppa0h2", "metadata": {"barcode": "TCTTCT", "material": "PA6", "time": "0d", "replicat": 2.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 142.0}, {"id": "Ppa15j1", "metadata": {"barcode": "CCCGGC", "material": "PA6", "time": "15d", "replicat": 1.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 31244.0}, {"id": "Ppa15j2", "metadata": {"barcode": "CTCGGT", "material": "PA6", "time": "15d", "replicat": 2.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 30382.0}, {"id": "Ppa15j3", "metadata": {"barcode": "TCGAAC", "material": "PA6", "time": "15d", "replicat": 3.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 31038.0}, {"id": "Ppa18h1", "metadata": {"barcode": "ATCGGG", "material": "PA6", "time": "01d", "replicat": 1.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 48581.0}, {"id": "Ppa18h2", "metadata": {"barcode": "AGTCGG", "material": "PA6", "time": "01d", "replicat": 2.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 53275.0}, {"id": "Ppa18h3", "metadata": {"barcode": "TACTCA", "material": "PA6", "time": "01d", "replicat": 3.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 59631.0}, {"id": "Ppa21j1", "metadata": {"barcode": "GTGTTT", "material": "PA6", "time": "21d", "replicat": 1.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 54489.0}, {"id": "Ppa21j2", "metadata": {"barcode": "ACCCCC", "material": "PA6", "time": "21d", "replicat": 2.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 64598.0}, {"id": "Ppa21j3", "metadata": {"barcode": "ACTTTT", "material": "PA6", "time": "21d", "replicat": 3.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 77009.0}, {"id": "Ppa24h1", "metadata": {"barcode": "ATAACG", "material": "PA6", "time": "02d", "replicat": 1.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 51403.0}, {"id": "Ppa24h2", "metadata": {"barcode": "GAGGGC", "material": "PA6", "time": "02d", "replicat": 2.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 46452.0}, {"id": "Ppa24h3", "metadata": {"barcode": "TACAAG", "material": "PA6", "time": "02d", "replicat": 3.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 49210.0}, {"id": "Ppa5j1", "metadata": {"barcode": "CGTTTC", "material": "PA6", "time": "05d", "replicat": 1.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 55330.0}, {"id": "Ppa5j2", "metadata": {"barcode": "CCCGTT", "material": "PA6", "time": "05d", "replicat": 2.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 57842.0}, {"id": "Ppa5j3", "metadata": {"barcode": "GGTCAC", "material": "PA6", "time": "05d", "replicat": 3.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 55489.0}, {"id": "Ppa8j1", "metadata": {"barcode": "AGTGCT", "material": "PA6", "time": "08d", "replicat": 1.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 60681.0}, {"id": "Ppa8j2", "metadata": {"barcode": "GACATC", "material": "PA6", "time": "08d", "replicat": 2.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 76489.0}, {"id": "Ppet15j1", "metadata": {"barcode": "CTTAAA", "material": "PET", "time": "15d", "replicat": 1.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 26371.0}, {"id": "Ppet15j2", "metadata": {"barcode": "TAAGGG", "material": "PET", "time": "15d", "replicat": 2.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 29898.0}, {"id": "Ppet15j3", "metadata": {"barcode": "ATCGTT", "material": "PET", "time": "15d", "replicat": 3.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 30307.0}, {"id": "Ppet18h1", "metadata": {"barcode": "GTTCTT", "material": "PET", "time": "01d", "replicat": 1.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 54782.0}, {"id": "Ppet18h2", "metadata": {"barcode": "ACAGAC", "material": "PET", "time": "01d", "replicat": 2.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 61656.0}, {"id": "Ppet18h3", "metadata": {"barcode": "GTTGCG", "material": "PET", "time": "01d", "replicat": 3.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 50046.0}, {"id": "Ppet21j1", "metadata": {"barcode": "GAGCAA", "material": "PET", "time": "21d", "replicat": 1.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 54684.0}, {"id": "Ppet21j2", "metadata": {"barcode": "ACTGCG", "material": "PET", "time": "21d", "replicat": 2.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 55229.0}, {"id": "Ppet21j3", "metadata": {"barcode": "GGCCTC", "material": "PET", "time": "21d", "replicat": 3.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 63976.0}, {"id": "Ppet24h1", "metadata": {"barcode": "AAACTC", "material": "PET", "time": "02d", "replicat": 1.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 57590.0}, {"id": "Ppet24h2", "metadata": {"barcode": "AGAAGT", "material": "PET", "time": "02d", "replicat": 2.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 51057.0}, {"id": "Ppet24h3", "metadata": {"barcode": "TCTTAA", "material": "PET", "time": "02d", "replicat": 3.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 54521.0}, {"id": "Ppet5j1", "metadata": {"barcode": "CGCGTG", "material": "PET", "time": "05d", "replicat": 1.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 52633.0}, {"id": "Ppet5j2", "metadata": {"barcode": "GCGCCC", "material": "PET", "time": "05d", "replicat": 2.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 55159.0}, {"id": "Ppet5j3", "metadata": {"barcode": "AAGGCC", "material": "PET", "time": "05d", "replicat": 3.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 55558.0}, {"id": "Ppet8j1", "metadata": {"barcode": "TGCACG", "material": "PET", "time": "08d", "replicat": 1.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 50330.0}, {"id": "Ppet8j2", "metadata": {"barcode": "CAGTGA", "material": "PET", "time": "08d", "replicat": 2.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 56255.0}, {"id": "Ppet8j3", "metadata": {"barcode": "GCCGGT", "material": "PET", "time": "08d", "replicat": 3.0, "extraction_method": "PBF", "year": 2017.0, "month": "november", "ageing": "unaged"}, "frequency": 63211.0}]}, {"transform": [{"type": "aggregate", "groupby": ["selectedCategory"]}], "name": "groupedBySelectedCategory", "source": "table"}, {"transform": [{"expr": "datum.frequency >= samplingDepth", "type": "filter"}, {"type": "aggregate", "groupby": ["selectedCategory"]}], "name": "groupedBySelectedCategoryAndRetained", "source": "table"}], "signals": [{"name": "width", "value": "", "bind": {"input": "text"}, "on": [{"events": {"source": "window", "type": "resize"}, "update": "containerSize()[0]"}]}, {"name": "chartHeight", "update": "width / 2.5"}, {"name": "chartOffset", "value": 20}, {"name": "height", "update": "chartHeight + chartOffset"}, {"name": "tooltip", "value": {}, "on": [{"events": "rect:mouseover", "update": "datum"}, {"events": "rect:mouseout", "update": "{}"}]}, {"bind": {"input": "select", "options": ["barcode", "material", "time", "replicat", "extraction_method", "year", "month", "ageing"], "element": "#metadata-category"}, "name": "category", "value": "barcode"}, {"bind": {"input": "range", "element": "#sampling-depth-slider", "max": 77009, "min": 0, "step": 1}, "name": "samplingDepth", "value": 0}], "marks": [{"description": "Interactive rarefaction summary plot", "name": "rarefactionplot", "type": "group", "encode": {"enter": {"x": {"value": 0}, "y": {"signal": "chartOffset"}, "width": {"value": 200}, "height": {"signal": "chartHeight"}}}, "marks": [{"type": "rect", "from": {"data": "groupedBySelectedCategory"}, "encode": {"enter": {"x": {"scale": "xscale", "field": "selectedCategory"}, "width": {"scale": "xscale", "band": 1}, "y": {"scale": "yscale", "field": "count"}, "y2": {"scale": "yscale", "value": 0}}, "update": {"tooltip": {"signal": "{'title': datum.selectedCategory, 'Total Samples': datum.count}"}, "fill": {"value": "#D3D3D3"}}}}, {"type": "rect", "from": {"data": "groupedBySelectedCategoryAndRetained"}, "encode": {"enter": {"x": {"scale": "xscale", "field": "selectedCategory"}, "width": {"scale": "xscale", "band": 1}, "y": {"scale": "yscale", "field": "count"}, "y2": {"scale": "yscale", "value": 0}}, "update": {"tooltip": {"signal": "{'title': datum.selectedCategory, 'Samples Retained': datum.count}"}, "y": {"scale": "yscale", "field": "count"}, "y2": {"scale": "yscale", "value": 0}, "fill": {"value": "#1F77B4"}}, "hover": {"fill": {"value": "#60B3F7"}}}}, {"type": "text", "encode": {"enter": {"align": {"value": "center"}, "baseline": {"value": "top"}, "fill": {"value": "#000000"}}, "update": {"x": {"scale": "xscale", "signal": "tooltip.selectedCategory", "band": 0.5}, "y": {"scale": "yscale", "signal": "tooltip.count", "offset": -12}, "text": {"signal": "tooltip.count"}, "fillOpacity": [{"test": "datum === tooltip", "value": 0}, {"value": 1}]}}}], "scales": [{"name": "xscale", "type": "band", "domain": {"data": "groupedBySelectedCategory", "field": "selectedCategory", "sort": true}, "range": "width", "padding": 0.1, "round": true}, {"name": "yscale", "domain": {"fields": [{"data": "groupedBySelectedCategory", "field": "count"}]}, "nice": true, "range": [{"signal": "chartHeight"}, 0]}], "axes": [{"orient": "bottom", "scale": "xscale", "title": {"signal": "category"}, "labelAngle": 90, "labelAlign": "left", "labelBaseline": "middle"}, {"orient": "left", "scale": "yscale", "title": "Number of Samples", "tickMinStep": 1}]}]}
</script>

<script type="text/javascript">
  $(document).ready(function() {
    var spec = JSON.parse(document.getElementById("spec").innerHTML);

    // Try and come up with a good initial estimate of plot dimensions,
    // based on the browser dimensions.
    var opts = {
      width: $("#plot").width(),
      height: $("#plot").width() / 2.5
    };

    vegaEmbed("#plot", spec, opts)
      .then(function(result) {
        result.view.logLevel(vega.Warn);
        // Stash the view object in global namespace for debugging purposes.
        // Check out https://vega.github.io/vega/docs/api/debugging/
        // for more details.
        window.v = result.view;
      })
      .catch(function(error) {
        // From 'js-error-handler.html'
        handleErrors([error], $("#plot"));
      });

    // Clean up the vega-embed toolbar
    var toolbar = $("div .vega-actions").detach();
    toolbar.addClass("btn-group");
    toolbar.children("a").each(function() {
      $(this).addClass("btn btn-default");
    });

    toolbar.appendTo("#toolbar");

    var category = $("#metadata-category .vega-bind");
    category
      .children(".vega-bind-name")
      .replaceWith("<label> Metadata Category &nbsp;</label>");
    category.children("select").addClass("form-control");

    var samplingDepthSlider = $("#sampling-depth-slider .vega-bind");
    $(samplingDepthSlider)
      .find("label")
      .remove();
    $(samplingDepthSlider)
      .find("input")
      .attr("id", "range-slider");
    $(samplingDepthSlider)
      .find("input")
      .attr("oninput", "sliderHelperFunction(this.value);");
    $(samplingDepthSlider).prepend(
      "<label> Sampling Depth &nbsp; </label> <br>"
    );
    $(samplingDepthSlider).append(
      '<br> <input id="text-box" class="form-control" type="number" value="0" min="0" oninput="textBoxHelperFunction(this.value);" />'
    );
    $(samplingDepthSlider).append("(zero implies no even sampling)");
    samplingDepthSlider.children(".vega-bind-name").replaceWith("");

    var rotateLabels = $("#rotate-labels .vega-bind");
    rotateLabels
      .children(".vega-bind-name")
      .replaceWith("<label> Rotate Labels &nbsp;</label>");
    rotateLabels.children("checkbox").addClass("form-control");
  });
</script>


<div class="row">
  <div class="col-lg-8">
    <table id="feature-table" class="table table-striped">
      <thead>
        <tr>
          <th scope="col">Sample ID</th>
          <th scope="col">Feature Count</th>
        </tr>
      </thead>
      <tbody id="table-body"></tbody>
    </table>
  </div>
</div>

<script id="table-data" type="application/json">
{"Ppa21j3":77009.0,"Ppa8j2":76489.0,"Cpet0h1":66305.0,"Cpa0h1":65077.0,"Ppa21j2":64598.0,"Ppet21j3":63976.0,"Ppet8j3":63211.0,"Ppet18h2":61656.0,"Ppa8j1":60681.0,"Ppa18h3":59631.0,"Cpet0h2":59018.0,"Ppa5j2":57842.0,"Ppet24h1":57590.0,"Ppet8j2":56255.0,"Ppet5j3":55558.0,"Ppa5j3":55489.0,"Ppa5j1":55330.0,"Ppet21j2":55229.0,"Ppet5j2":55159.0,"Ppet18h1":54782.0,"Ppet21j1":54684.0,"Ppet24h3":54521.0,"Ppa21j1":54489.0,"Ppa18h2":53275.0,"Ppet5j1":52633.0,"Cpa18h1":52281.0,"Ppa24h1":51403.0,"Ppet24h2":51057.0,"Ppet8j1":50330.0,"Ppet18h3":50046.0,"Cpa8j3":49522.0,"Ppa24h3":49210.0,"Ppa18h1":48581.0,"Cpa21j1":46970.0,"Ppa24h2":46452.0,"Cpa8j2":44787.0,"Cpa24h2":42824.0,"Cpet21j1":42413.0,"Cpa18h2":42027.0,"Cpet5j3":41489.0,"Cpa21j2":40930.0,"Cpa0h2":40479.0,"Cpa18h3":40354.0,"Cpet21j2":40278.0,"Cpa21j3":39262.0,"Cpet8j2":38671.0,"Cpet18h2":38005.0,"Cpa5j1":37588.0,"Cpet8j3":37558.0,"Cpet8j1":36578.0,"Cpet21j3":36480.0,"Cpa24h3":35865.0,"Cpa5j3":35638.0,"Cpa8j1":35356.0,"Cpa5j2":34470.0,"Ppa15j1":31244.0,"Ppa15j3":31038.0,"Ppa15j2":30382.0,"Ppet15j3":30307.0,"Ppet15j2":29898.0,"Cpet24h2":29362.0,"Cpet5j2":28662.0,"Cpet18h1":27336.0,"Ppet15j1":26371.0,"Cpet5j1":26254.0,"Cpa24h1":25647.0,"Cpet18h3":24351.0,"Cpet24h3":23578.0,"Cpet24h1":22113.0,"Cpa15j2":21089.0,"Cpet15j2":18909.0,"Cpa15j1":18890.0,"Cpet15j1":18551.0,"Cpet15j3":17485.0,"Cpa15j3":15879.0,"Ppa0h2":142.0,"Ppa0h1":26.0}
</script>

<script type="text/javascript">
  var totalFrequencies = 3264905;
  var sampleCount = 77;
  var defaultDescription = "Retained " + (totalFrequencies.toLocaleString('en'))
                                       + " (100.00%) features in "
                                       + sampleCount + " (100.00%) samples at the specifed sampling depth.";


  var textField = document.getElementById('text-field');
  var tableBody = document.getElementById("table-body");
  var table = document.getElementById("feature-table");

  // when the viz loads the default description is displayed
  textField.innerHTML = defaultDescription;

  var sampleFrequency = JSON.parse(document.getElementById("table-data").innerHTML);
  // get object keys and store them in an ascending order based on the key value
  // this order is used to create the table rows
  sortedSampleIDs = Object.keys(sampleFrequency).sort(function(a, b) {
    var temp = sampleFrequency[a] - sampleFrequency[b];
    // if two samples have the same number of features then we
    // determine the order using the sample ID alphabetical order
    if (temp == 0){
      return b.localeCompare(a);
    }

  return temp;
  });

  sortedSampleIDs.forEach(function(element) {
    var row = tableBody.insertRow(0);
    var cell1 = row.insertCell(0);
    var cell2 = row.insertCell(1);
    cell1.innerHTML = element;
    cell2.innerHTML = sampleFrequency[element];

  });


  function updateTableandText(val) {
    var retainedSampleCount = 0;

    // start the counter at 1 to ignore the header row
    for (var i = 1; row = table.rows[i]; i++) {

      if (Number(row.cells[1].innerHTML) < val) {
        row.className = "danger";
      } else {
        row.className = "";
        retainedSampleCount += 1;
      }
    }
    if (val == 0){

    textField.innerHTML = defaultDescription;

    }
    else{
      var retainedFeatureCount = retainedSampleCount * val;
      textField.innerHTML = "Retained " + retainedFeatureCount.toLocaleString('en')
                                        + " (" + (retainedFeatureCount/totalFrequencies*100).toFixed(2) + "%) features in "
                                        + retainedSampleCount + " (" + (retainedSampleCount/sampleCount*100).toFixed(2)
                                        +  "%) samples at the specifed sampling depth.";
    }

  }


  function updateSliderVal(val) {
    var slider = document.getElementById("range-slider");
    slider.value = val;
    slider.dispatchEvent(new Event("change"));
    slider.dispatchEvent(new Event("input"));
  }


  function updateBoxVal(val) {
    var num = document.getElementById("text-box");
    num.value = val;
  }


  function sliderHelperFunction(val){
    updateBoxVal(val);
    updateTableandText(val);

  }


  function textBoxHelperFunction(val){
    val = parseInt(val);
    if (val !== val) {
      val = 0;
    }

    // make sure the value in the textbox cannot exceed the max count
    if (val > 77009.0){
      var num = document.getElementById("text-box");
      num.value = 77009.0;
    }
    updateSliderVal(val);
  }
</script>


    </div>
  </div>


    </div>
    <script type="text/javascript">
      if (window.frameElement) {
          document.getElementById('q2templatesheader').remove();
      }
    </script>
    

  </body>
</html>